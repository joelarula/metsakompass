(function(t){function e(e){for(var r,d,s=e[0],i=e[1],l=e[2],p=0,u=[];p<s.length;p++)d=s[p],n[d]&&u.push(n[d][0]),n[d]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);c&&c(e);while(u.length)u.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,s=1;s<a.length;s++){var i=a[s];0!==n[i]&&(r=!1)}r&&(o.splice(e--,1),t=d(d.s=a[0]))}return t}var r={},n={app:0},o=[];function d(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,d),a.l=!0,a.exports}d.m=t,d.c=r,d.d=function(t,e,a){d.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},d.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},d.t=function(t,e){if(1&e&&(t=d(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(d.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)d.d(a,r,function(e){return t[e]}.bind(null,r));return a},d.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return d.d(e,"a",e),e},d.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},d.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var c=i;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var r=a("64a9"),n=a.n(r);n.a},1:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-container",[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:""}},[a("div",{attrs:{id:"toolbar"}},[a("div",{attrs:{id:"diagrams"}},[a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getDColor(1)},nativeOn:{click:function(e){return t.setDiagram(1)}}},[t._v("Osalus")]),a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getDColor(2)},nativeOn:{click:function(e){return t.setDiagram(2)}}},[t._v("Osalejad")]),a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getDColor(3)},nativeOn:{click:function(e){return t.setDiagram(3)}}},[t._v("Tulemus")])],1),a("div",{attrs:{id:"items"}},[t._v("\t\n \t       \tJärjestan:\n \t       \t"),a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getColor(1)},nativeOn:{click:function(e){return t.setSort(1)}}},[t._v("Metsasõbrad")]),a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getColor(2)},nativeOn:{click:function(e){return t.setSort(2)}}},[t._v("Ringkond")]),a("v-btn",{attrs:{round:"",small:"",dark:"",color:t.getColor(3)},nativeOn:{click:function(e){return t.setSort(3)}}},[t._v("Erakond")])],1)]),a("div",{attrs:{id:"metsakompass"}},[a("div",{attrs:{id:"diagrammid"}},[a("div",{class:t.showDiagram(1),attrs:{id:"diagram2"}},[a("div",{attrs:{id:"respondedTotal"}})]),a("div",{class:t.showDiagram(2),attrs:{id:"diagram1"}},[a("div",{attrs:{id:"d1"}},[a("div",{attrs:{id:"responded"}}),a("div",{attrs:{id:"notresponded"}})]),a("div",{attrs:{id:"repondedChip"}},[t._v("Vastanud kandidaate "+t._s(t.respondersTotal))]),a("div",{attrs:{id:"notrepondedChip"}},[t._v("Mittevastanud kandidaate "+t._s(t.notRespondersTotal))])]),a("div",{class:t.showDiagram(3),attrs:{id:"diagram3"}},t._l(t.sortParties,function(e){return a("div",[a("v-layout",[a("v-flex",{attrs:{sm1:"",xs1:"",md1:""}},[a("span",{staticClass:"ix",attrs:{title:e.total}},[t._v(t._s(e.i)+".")])]),a("v-flex",{attrs:{sm3:"",xs3:"",md3:""}},[a("div",{staticClass:"plogo",style:t.getStyle(e),attrs:{title:e.name}})]),a("v-flex",{attrs:{sm3:"",xs3:"",md3:""}},[a("v-btn",{attrs:{color:t.getCandidateColor(e.total),fab:"",dark:""}})],1)],1)],1)}),0)]),a("div",{attrs:{id:"table"}},[a("div",{attrs:{id:"nimekiri"}},[a("v-data-table",{attrs:{"hide-actions":"","hide-headers":"",headers:t.tableHeaders,items:t.sortCandidates},scopedSlots:t._u([{key:"items",fn:function(e){return[e.item.divider?[a("td",{attrs:{colspan:"3"}},[a("a",{staticClass:"elabel",attrs:{href:e.item.code}},[t._v(t._s(e.item.name))])])]:[a("td",[t._v(t._s(e.item.name))]),a("td",{staticClass:"text-xs-right"},[1==t.sort?[t._v("\n      \t\t \t\t"+t._s(e.item.erakond)+"\n      \t\t \t")]:[3==t.sort?[t._v("\n      \t\t \t\t\t"+t._s(e.item.ringkond)+"\n      \t\t \t\t")]:[t._v("\n      \t\t \t\t\t"+t._s(e.item.erakond)+"\n      \t\t \t\t")]]],2),a("td",{staticClass:"text-xs-right"},[a("v-tooltip",{attrs:{right:""}},[[a("v-btn",{attrs:{slot:"activator",color:t.getCandidateColor(e.item.total),fab:"",dark:""},slot:"activator"},[t._v("\n    \t\t \t\t\t\t\t"+t._s(e.item.nr)+"\n    \t\t \t\t\t\t")])],a("div",[a("div",[t._v(" Petitsioon:  "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.petitsioon)},[t._v("■")])]),a("div",[t._v(" Biomass: "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.biomass)},[t._v("■")])]),a("div",[t._v(" Raiemaht: "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.raiemaht)},[t._v("■")])]),a("div",[t._v(" Metsamajandus: "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.majandus)},[t._v("■")])]),a("div",[t._v(" Jaht: "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.jaht)},[t._v("■")])]),a("div",[t._v(" Poliitika: "),a("span",{staticClass:"cbullet",style:t.getCandidateColorB(e.item.poliitika)},[t._v("■")])])])],2)],1)]]}}])})],1)])])]),t.loaded?t._e():[a("v-flex",{attrs:{xs12:""}},[a("v-progress-circular",{attrs:{"align-center":"",size:200,color:"green",width:15,indeterminate:""}},[t._v("Metsakompass \n    laen andmeid \n    ...")])],1)]],2)],1)],1)],1)},o=[],d=(a("7f7f"),a("55dd"),a("59ad")),s=a.n(d),i=a("e814"),l=a.n(i),c=(a("ac6a"),a("28dd")),p=a("67b0");r["a"].use(p["a"]),r["a"].use(c["a"]);var u={name:"app",data:function(){return{API_KEY:"AIzaSyBm00X5S1A4rNc4MlyR6yRyQaR5un7Qb40",api:"https://sheets.googleapis.com/v4/spreadsheets/11r-tkO-eiBq-Nwj3au7UPEDq4hvc8xuvykwGDIgvgW8",sheet1:"https://sheets.googleapis.com/v4/spreadsheets/11r-tkO-eiBq-Nwj3au7UPEDq4hvc8xuvykwGDIgvgW8/values/Sheet1!A1:M1025",candidates:[],headers:[],loaded:!1,sort:1,diagram:1,candidatesTotal:0,respondersTotal:0,notRespondersTotal:0,chars:["a","b","c","d","e","f","g","h","i","j","k","l"],parties:{"Erakond Eestimaa Rohelised":{code:"ER",color:"#89B046",image:"/images/rohelised.png",candidates:0,responded:0,notresponded:0,order:"a",total:0},"Elurikkuse Erakond":{code:"EE",color:"#F7C640",image:"/images/ere.png",candidates:0,responded:0,notresponded:0,order:"b",total:0},"Erakond Eesti 200":{code:"E200",color:"#31758A",image:"/images/eesti200.png",candidates:0,responded:0,notresponded:0,order:"c",total:0},"Isamaa Erakond":{code:"IE",color:"#009CE2",image:"/images/isamaa.png",candidates:0,responded:0,notresponded:0,order:"d",total:0},"Eesti Reformierakond":{code:"RE",color:"#FFE200",image:"/images/reform.png",candidates:0,responded:0,notresponded:0,order:"e",total:0},"Eesti Keskerakond":{code:"KE",color:"#007557",image:"/images/kesk.png",candidates:0,responded:0,notresponded:0,order:"f",total:0},"Eesti Vabaerakond":{code:"EV",color:"#0089D1",image:"/images/vaba.png",candidates:0,responded:0,notresponded:0,order:"g",total:0},"Eesti Konservatiivne Rahvaerakond":{code:"EK",image:"/images/ekre.png",color:"#0077BD",candidates:0,responded:0,notresponded:0,order:"h",total:0},"Sotsiaaldemokraatlik Erakond":{code:"SE",color:"#E10600",image:"/images/sde.png",candidates:0,responded:0,notresponded:0,order:"i",total:0}},responded:{name:"responded",color:"transparent",children:[]},notresponded:{name:"notrespondedTotal",color:"transparent",children:[]},respondedTotal:{name:"responded",color:"transparent",children:[]},tableHeaders:[{name:"Kandidaat",sortable:!1},{name:"Erakond",sortable:!1},{name:"Number",sortable:!1}]}},created:function(){var t=this;r["a"].loadScript("http://d3js.org/d3.v2.js").then(function(){console.log("done loading"),t.$http.get(t.sheet1,{params:{key:t.API_KEY}}).then(function(e){var a=e.body.values.shift();t.headers=a;var r=a.indexOf("Erakonna nimekiri"),n=a.indexOf("Vastanud"),o=a.indexOf("First Name"),d=a.indexOf("Last Name"),i=a.indexOf("Kandidaadi number"),c=a.indexOf("Omavalitsus"),p=a.indexOf("Petitsioon"),u=a.indexOf("Biomass"),v=a.indexOf("Raiemaht"),f=a.indexOf("Metsamajandus"),g=a.indexOf("Jaht"),m=a.indexOf("Poliitika");for(var h in e.body.values){var k=e.body.values[h],b=t.parties[k[r]],C=k[n],x=k[i],y=null!=k[c]?k[c]:"x";k.nr=x,k.ringkond=y,k.divider=!1,k.erakond=k[r],k.name=k[o]+" "+k[d],k.petitsioon=0!=k[p].length?l()(k[p]):0,k.biomass=0!=k[u].length?l()(k[u]):0,k.raiemaht=0!=k[v].length?l()(k[v]):0,k.majandus=0!=k[f].length?l()(k[f]):0,k.jaht=0!=k[g].length?l()(k[g]):0,k.poliitika=0!=k[m].length?l()(k[m]):0,k.total=s()((k.petitsioon+k.biomass+k.raiemaht+k.majandus+k.jaht+k.poliitika)/6),isNaN(k.total)&&(k.total=0),void 0!=b&&(k.party=b,b.candidates++,t.candidatesTotal++,void 0!=C&&"x"==C?(t.respondersTotal++,b.responded++,b.total=b.total+k.total,t.candidates.push(k)):(b.notresponded++,t.notRespondersTotal++))}var _=[];for(var b in t.parties){r=t.parties[b];r.total=s()(r.total/r.responded),_.push({responded:r.responded,party:b}),r.responded>0?(t.responded.children.push({name:b,total:r.candidates,code:r.code,color:r.color,responded:r.responded,size:t.calculateRespondedPercent(r)}),t.notresponded.children.push({name:b,total:r.candidates,code:r.code,color:r.color,notresponded:r.notresponded,size:t.calculateNotRespondedPercent(r)})):t.notresponded.children.push({name:b,total:r.candidates,code:r.code,color:r.color,notresponded:r.notresponded,size:t.calculateNotRespondedPercent(r)})}for(var T in t.respondedTotal.children.push({name:"responded",color:"#75F212",size:t.calculateRespondedTotal()}),t.respondedTotal.children.push({name:"notresponded",color:"red",size:t.calculatenotRespondedTotal()}),_.sort(function(t,e){return e.responded-t.responded}),_){b=_[T];t.parties[b.party].order=t.chars[T]}t.drawTotalChart(t.respondedTotal,"#respondedTotal"),t.drawFeedbackChart(t.responded,"#responded"),t.drawFeedbackChart(t.notresponded,"#notresponded"),t.loaded=!0})})},computed:{sortParties:function(){var t=1,e=[];for(var a in this.parties){var r=this.parties[a];r.name=a,r.i=t,e.push(r),t++}return e.sort(function(t,e){return t.order.localeCompare(e.order)}),e},sortCandidates:function(){if(1==this.sort)return this.candidates.sort(function(t,e){return t.total-e.total});if(3==this.sort){var t="",e=this.candidates.sort(function(t,e){var a=(void 0!=t.party?t.party.order:"j")+t.erakond+t[2]+t[1],r=(void 0!=e.party?e.party.order:"j")+e.erakond+e[2]+e[1];return a.localeCompare(r)}),a=[];for(var r in e){var n=e[r];0!=n.erakond.localeCompare(t)&&(t=n.erakond,a.push({name:n.erakond,divider:!0,code:n.party?"#"+n.party.code:"#YX"})),a.push(n)}return a}var o="";e=this.candidates.sort(function(t,e){var a=t.ringkond+t.erakond+t[2]+t[1],r=e.ringkond+e.erakond+e[2]+e[1];return a.localeCompare(r)}),a=[];for(var r in e){n=e[r];0!=n.ringkond.localeCompare(o)&&(o=n.ringkond,a.push({name:n.ringkond,divider:!0,code:"#"+n.ringkond})),a.push(n)}return a}},methods:{drawTotalChart:function(t,e){var a=380,r=280,n=(d3.format(",d"),d3.layout.pack().size([a-10,r-0]).value(function(t){return t.size}).nodes(t)),o=d3.select(e).append("svg:svg").attr("width",a).attr("height",r).attr("class","pack").append("svg:g").attr("transform","translate(2, 2)"),d=o.selectAll("g.node").data(n).enter().append("svg:g").attr("class",function(t){return t.children?"node":"leaf node"}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"});d.append("svg:circle").attr("r",function(t){return t.r}).attr("fill",function(t){return t.color}),d.append("svg:text").attr("text-anchor","middle").attr("class","ptotals").attr("fill","white").attr("font-size","18").attr("font-weight","bold").text(function(t){return t.size+"%"})},drawFeedbackChart:function(t,e){var a=400,r=300,n=(d3.format(",d"),d3.layout.pack().size([a-4,r-4]).value(function(t){return t.size}).nodes(t)),o=d3.select(e).append("svg:svg").attr("width",a).attr("height",r).attr("class","pack").append("svg:g").attr("transform","translate(2, 2)"),d=o.append("svg:defs");for(var s in this.parties){var i=this.parties[s];d.append("svg:filter").attr("id",i.code).attr("x","0%").attr("y","0%").attr("height","100%").attr("width","100%").append("feImage").attr("xlink:href",i.image)}var l=o.selectAll("g.node").data(n).enter().append("svg:g").attr("class",function(t){return t.children?"node":"leaf node"}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"});"#responded"==e?l.append("svg:title").attr("class","percentTitle").text(function(t){return t.name+" Vastanuid "+t.responded+" kandidaati.  "+t.size+" %"}):l.append("svg:title").text(function(t){return t.name+" Mittevastanuid "+t.notresponded+" kandidaati.  "+t.size+" %"}),l.append("svg:circle").attr("r",function(t){return t.r}).attr("class",function(t){return t.responded?"responded":"notresponded"}).attr("fill",function(t){return t.color}).attr("filter",function(t){return"url(#"+t.code+")"}).attr("title",function(t){return t.name}).on("click",function(t){console.log(t)}),l.filter(function(t){return!t.children}).append("svg:text").attr("text-anchor","middle").attr("class","percentTitle").text(function(t){return t.size+" %"})},calculateRespondedPercent:function(t){return s()(100/t.candidates*t.responded).toFixed(0)},calculateNotRespondedPercent:function(t){return s()(100/t.candidates*(t.candidates-t.responded)).toFixed(0)},calculateRespondedTotal:function(){return s()(100/this.candidatesTotal*this.respondersTotal).toFixed(0)},calculatenotRespondedTotal:function(){return s()(100/this.candidatesTotal*this.notRespondersTotal).toFixed(0)},getColor:function(t){return this.sort==t?"light-green lighten-1":"blue-grey lighten-1"},getDColor:function(t){return this.diagram==t?"light-green lighten-1":"blue-grey lighten-1"},setSort:function(t){this.sort=t},setDiagram:function(t){this.diagram=t},computeLoaded:function(){return this.loaded?"loaded":"unloaded"},showDiagram:function(t){return this.diagram==t?"vis":"hid"},getStyle:function(t){return"background-image: url('"+t.image+"');"},getCandidateColor:function(t){return 0==t?"#757575":t<1.22?"#75F212":t<1.44?"#75F212":t<1.66?"#689F38":t<1.88?"lime":t<2.1?"orange":t<2.32?"orange":t<2.54?"red":t<2.76?"red":t>2.76?"red":void 0},getCandidateColorB:function(t){var e="";return 0==t?e="#757575":t<1.22?e="#75F212":t<1.44?e="#75F212":t<1.66?e="#689F38":t<1.88?e="lime":t<2.1?e="orange":t<2.32?e="orange":t<2.54?e="red":t<2.76?e="red":t>2.76&&(e="red"),"color: "+e+";"}}},v=u,f=(a("034f"),a("2877")),g=Object(f["a"])(v,n,o,!1,null,null,null),m=g.exports,h=a("bb71"),k=a("a722"),b=a("549c"),C=a("a523"),x=a("2a7f"),y=a("7496"),_=a("490a"),T=a("3a2f"),E=a("71d9"),O=a("132d"),w=a("8336"),j=a("0e8f"),R=a("8fea"),P=a("cc20");a("da64"),a("d1e7");r["a"].use(h["a"],{components:{VLayout:k["a"],VContent:b["a"],VContainer:C["a"],VToolbarItems:x["a"],VApp:y["a"],VProgressCircular:_["a"],VTooltip:T["a"],VToolbar:E["a"],VIcon:O["a"],VBtn:w["a"],VFlex:j["a"],VDataTable:R["a"],VChip:P["a"]}}),r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(m)}}).$mount("#app")},"64a9":function(t,e,a){}});
//# sourceMappingURL=app.a577b2d0.js.map